## 匿名函数

* [基本语法](#基本语法)

### 基本语法

附例一：

```php
<?php

declare(strict_types = 1);

$foo = preg_replace_callback('/^([a-z]*)$/', function ($matches) {
    return strtoupper($matches[1]);
}, 'foo');

var_dump($foo); // string(3) "FOO"

```

附例二：

```php
<?php

declare(strict_types = 1);

/**
 * Just a test function.
 *
 * @param  string $string
 * @return string
 */
$foo = function (string $string): string {
    return $string;
};

var_dump($foo('foo')); // string(3) "foo"

```

附例三：

```php
<?php

declare(strict_types = 1);

$string = 'foo';

/**
 * Inherit variables from the parent scope.
 *
 * @param  void
 * @return string
 */
$foo = function () use ($string): string {
    return $string;
};

var_dump($foo()); // string(3) "foo"

```

附例四：

```php
<?php

declare(strict_types = 1);

$string = 'foo';

/**
 * Inherit variables from the parent scope.
 *
 * @param  void
 * @return string
 */
$foo = function () use ($string): string {
    return $string;
};

$string = 'bar';

var_dump($foo()); // string(3) "foo"

```

附例五：

```php
<?php

declare(strict_types = 1);

$string = 'foo';

/**
 * Inherit references from the parent scope.
 *
 * @param  void
 * @return string
 */
$foo = function () use (&$string): string {
    return $string;
};

$string = 'bar';

var_dump($foo($string)); // string(3) "bar"

```

附例六：

```php
<?php

declare(strict_types = 1);

class Foo
{
    /**
     * Automatic binding of $this.
     *
     * @param  void
     * @return Closure
     */
    public function method(): Closure
    {
        /**
         * Return $this.
         *
         * @param  void
         * @return self
         */
        return function (): self {
            return $this;
        };
    }
}

$foo = new Foo;
$func = $foo->method();

var_dump($func()); // object(Foo)#1 (0) { }

```

附例七：

```php
<?php

declare(strict_types = 1);

class Foo
{
    /**
     * Just a test function.
     *
     * @param  void
     * @return Closure
     */
    public function method(): Closure
    {
        /**
         * Return $this.
         *
         * @param  void
         * @return self
         */
        return static function (): self {
            return $this;
        };
    }
}

$foo = new Foo;
$func = $foo->method();

var_dump($func()); // PHP Fatal error:  Uncaught Error: Using $this when not in object context.

```

