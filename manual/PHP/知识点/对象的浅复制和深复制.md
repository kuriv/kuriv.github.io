## 目录

* [浅复制](#浅复制)
* [深复制](#深复制)
    * [\_\_clone()](#\_\_clone)
    * [serialize()](#serialize)
    * [json_encode()](#json_encode)



## 浅复制

```php
<?php

declare(strict_types = 1);

class Cat
{
    /**
     * The name of cat.
     *
     * @var string
     */
    public $name;

    /**
     * The age of cat.
     *
     * @var int
     */
    public $age;

    /**
     * Save the name and age.
     *
     * @param  string $name
     * @param  int    $age
     * @return void
     */
    public function __construct(string $name, int $age)
    {
        $this->name = $name;
        $this->age = $age;
    }
}

class Dog
{
    /**
     * The name of dog.
     *
     * @var string
     */
    public $name;

    /**
     * Store an instance of cat.
     *
     * @var Cat
     */
    public $obj;
}

$spike = new Dog;
$spike->name = 'Spike';
$spike->obj = new Cat('Tom', 6);

$tyke = clone $spike;

var_dump($spike, $tyke);

$tyke->name = 'Tyke';
$tyke->obj->age = 2;

var_dump($spike, $tyke);

```

输出：

```
object(Dog)#1 (2) { ["name"]=> string(5) "Spike" ["obj"]=> object(Cat)#2 (2) { ["name"]=> string(3) "Tom" ["age"]=> int(6) } }
object(Dog)#3 (2) { ["name"]=> string(5) "Spike" ["obj"]=> object(Cat)#2 (2) { ["name"]=> string(3) "Tom" ["age"]=> int(6) } }

object(Dog)#1 (2) { ["name"]=> string(5) "Spike" ["obj"]=> object(Cat)#2 (2) { ["name"]=> string(3) "Tom" ["age"]=> int(2) } }
object(Dog)#3 (2) { ["name"]=> string(4) "Tyke" ["obj"]=> object(Cat)#2 (2) { ["name"]=> string(3) "Tom" ["age"]=> int(2) } }
```



## 深复制

### \_\_clone

```php
<?php

declare(strict_types = 1);

class Cat
{
    /**
     * The name of cat.
     *
     * @var string
     */
    public $name;

    /**
     * The age of cat.
     *
     * @var int
     */
    public $age;

    /**
     * Save the name and age.
     *
     * @param  string $name
     * @param  int    $age
     * @return void
     */
    public function __construct(string $name, int $age)
    {
        $this->name = $name;
        $this->age = $age;
    }
}

class Dog
{
    /**
     * The name of dog.
     *
     * @var string
     */
    public $name;

    /**
     * Store an instance of cat.
     *
     * @var Cat
     */
    public $obj;

    /**
     * Complete deep copy.
     *
     * @param  void
     * @return void
     */
    public function __clone()
    {
        $this->obj = clone $this->obj;
    }
}

$spike = new Dog;
$spike->name = 'Spike';
$spike->obj = new Cat('Tom', 6);

$tyke = clone $spike;

var_dump($spike, $tyke);

$tyke->name = 'Tyke';
$tyke->obj->age = 2;

var_dump($spike, $tyke);

```

输出：

```
object(Dog)#1 (2) { ["name"]=> string(5) "Spike" ["obj"]=> object(Cat)#2 (2) { ["name"]=> string(3) "Tom" ["age"]=> int(6) } }
object(Dog)#3 (2) { ["name"]=> string(5) "Spike" ["obj"]=> object(Cat)#4 (2) { ["name"]=> string(3) "Tom" ["age"]=> int(6) } }

object(Dog)#1 (2) { ["name"]=> string(5) "Spike" ["obj"]=> object(Cat)#2 (2) { ["name"]=> string(3) "Tom" ["age"]=> int(6) } }
object(Dog)#3 (2) { ["name"]=> string(4) "Tyke" ["obj"]=> object(Cat)#4 (2) { ["name"]=> string(3) "Tom" ["age"]=> int(2) } }
```

### serialize

```php
<?php

declare(strict_types = 1);

class Cat
{
    /**
     * The name of cat.
     *
     * @var string
     */
    public $name;

    /**
     * The age of cat.
     *
     * @var int
     */
    public $age;

    /**
     * Save the name and age.
     *
     * @param  string $name
     * @param  int    $age
     * @return void
     */
    public function __construct(string $name, int $age)
    {
        $this->name = $name;
        $this->age = $age;
    }
}

class Dog
{
    /**
     * The name of dog.
     *
     * @var string
     */
    public $name;

    /**
     * Store an instance of cat.
     *
     * @var Cat
     */
    public $obj;
}

$spike = new Dog;
$spike->name = 'Spike';
$spike->obj = new Cat('Tom', 6);

$tyke = unserialize(serialize($spike));

var_dump($spike, $tyke);

$tyke->name = 'Tyke';
$tyke->obj->age = 2;

var_dump($spike, $tyke);

```

输出：

```
object(Dog)#1 (2) { ["name"]=> string(5) "Spike" ["obj"]=> object(Cat)#2 (2) { ["name"]=> string(3) "Tom" ["age"]=> int(6) } }
object(Dog)#3 (2) { ["name"]=> string(5) "Spike" ["obj"]=> object(Cat)#4 (2) { ["name"]=> string(3) "Tom" ["age"]=> int(6) } }

object(Dog)#1 (2) { ["name"]=> string(5) "Spike" ["obj"]=> object(Cat)#2 (2) { ["name"]=> string(3) "Tom" ["age"]=> int(6) } }
object(Dog)#3 (2) { ["name"]=> string(4) "Tyke" ["obj"]=> object(Cat)#4 (2) { ["name"]=> string(3) "Tom" ["age"]=> int(2) } }
```

### json_encode

```php
<?php

declare(strict_types = 1);

class Cat
{
    /**
     * The name of cat.
     *
     * @var string
     */
    public $name;

    /**
     * The age of cat.
     *
     * @var int
     */
    public $age;

    /**
     * Save the name and age.
     *
     * @param  string $name
     * @param  int    $age
     * @return void
     */
    public function __construct(string $name, int $age)
    {
        $this->name = $name;
        $this->age = $age;
    }
}

class Dog
{
    /**
     * The name of dog.
     *
     * @var string
     */
    public $name;

    /**
     * Store an instance of cat.
     *
     * @var Cat
     */
    public $obj;
}

$spike = new Dog;
$spike->name = 'Spike';
$spike->obj = new Cat('Tom', 6);

$tyke = json_decode(json_encode($spike));

var_dump($spike, $tyke);

$tyke->name = 'Tyke';
$tyke->obj->age = 2;

var_dump($spike, $tyke);

```

输出：

```
object(Dog)#1 (2) { ["name"]=> string(5) "Spike" ["obj"]=> object(Cat)#2 (2) { ["name"]=> string(3) "Tom" ["age"]=> int(6) } }
object(stdClass)#3 (2) { ["name"]=> string(5) "Spike" ["obj"]=> object(stdClass)#4 (2) { ["name"]=> string(3) "Tom" ["age"]=> int(6) } }

object(Dog)#1 (2) { ["name"]=> string(5) "Spike" ["obj"]=> object(Cat)#2 (2) { ["name"]=> string(3) "Tom" ["age"]=> int(6) } }
object(stdClass)#3 (2) { ["name"]=> string(4) "Tyke" ["obj"]=> object(stdClass)#4 (2) { ["name"]=> string(3) "Tom" ["age"]=> int(2) } }
```